# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`comply`](#comply): Installs scarp and ciscat on a node
* [`comply::app_stack`](#complyapp_stack): Configure a node to run Comply
* [`comply::scanners::ciscat`](#complyscannersciscat): Installs a JRE
* [`comply::scanners::oscap`](#complyscannersoscap): Installs oscap on a system

### Functions

* [`report_errors`](#report_errors): Returns error details

Returns error details

### Data types

* [`Comply::Url`](#complyurl): Comply url

Comply url

### Tasks

* [`ciscat_scan`](#ciscat_scan): Run a ciscat scan and upload to scarp
* [`oscap_scan`](#oscap_scan): Run an oscap scan
* [`scarp`](#scarp): runs scarp

### Plans

* [`comply::demo_01_provision_machines`](#complydemo_01_provision_machines): Provisions machines
* [`comply::demo_02_pe_server_setup`](#complydemo_02_pe_server_setup): Install PE and comply on designated machine
* [`comply::demo_03_puppet_agents_setup`](#complydemo_03_puppet_agents_setup): Setup agents with scanners and java
* [`comply::demo_04_comply_stack_setup`](#complydemo_04_comply_stack_setup): Setup comply server

## Classes

### `comply`

Installs scarp and ciscat on a node

#### Examples

##### Use defaults

```puppet
include comply
```

##### Mange packages elsewhere

```puppet
class { 'comply':
  linux_manage_unzip  => false,
  windows_manage_jre8 => false,
}
```

#### Parameters

The following parameters are available in the `comply` class.

##### `linux_manage_unzip`

Data type: `Boolean`

Determines if this module should manage the installation of unzip on Linux

Default value: ``true``

##### `windows_manage_jre8`

Data type: `Boolean`

Determines if this module should manage the installation of jre8 on Windows

Default value: ``true``

##### `scanner_source`

Data type: `Pattern[/(\d+\.\d+.\d+)/]`

Supplies the storage location (URL) for the scanner. Required

Default value: `'puppet:///modules/comply/Assessor-CLI-v4.0.11.zip'`

### `comply::app_stack`

This class takes care of configuring a node to run Comply.

#### Examples

##### Use defalts or configure via Hiera

```puppet
include comply::app_stack
```

##### Manage the docker group elsewhere

```puppet
realize(Group['docker'])

class { 'comply::app_stack':
  create_docker_group => false,
  require             => Group['docker'],
}
```

#### Parameters

The following parameters are available in the `comply::app_stack` class.

##### `analytics`

Data type: `Boolean`

Enable/Disable collection of Analytic Data

Default value: ``true``

##### `create_docker_group`

Data type: `Boolean`

Ensure the docker group is present.

Default value: ``true``

##### `manage_docker`

Data type: `Boolean`

Install and manage docker as part of app_stack

Default value: ``true``

##### `https_port`

Data type: `Integer`

Secure port number to access the Comply UI

Default value: `443`

##### `scarp_address`

Data type: `String[1]`

The hostname or ip address of the SCARP API

Default value: `$facts['fqdn']`

##### `compose_version`

Data type: `String[1]`

The version of docker-compose to install

Default value: `'1.25.0'`

##### `image_prefix`

Data type: `String[1]`

The string that comes before the name of each
container. This can be changed to support private
image repositories such as for internal testing or
air gapped environments.

Default value: `'artifactory.delivery.puppetlabs.net/compliance/'`

##### `comply_version`

Data type: `String[1]`

The version of the Comply containers to use

Default value: `'latest'`

##### `log_driver`

Data type: `String[1]`

The log driver Docker will use

Default value: `'journald'`

##### `docker_users`

Data type: `Optional[Array[String[1]]]`

Users to be added to the docker group on the system

Default value: ``undef``

### `comply::scanners::ciscat`

CIS CAT Pro scanner requies a JRE as a prerequisite

#### Examples

#####

```puppet
include comply::scanners::ciscat
```

##### Mange packages elsewhere

```puppet
class { 'comply::ciscat':
  linux_manage_unzip  => false,
  windows_manage_jre8 => false,
}
```

#### Parameters

The following parameters are available in the `comply::scanners::ciscat` class.

##### `linux_manage_unzip`

Data type: `Boolean`

Determines if this module should manage the installation of unzip on Linux

Default value: `$comply::linux_manage_unzip`

##### `windows_manage_jre8`

Data type: `Boolean`

Determines if this module should manage the installation of jre8 on Windows

Default value: `$comply::windows_manage_jre8`

##### `scanner_source`

Data type: `Pattern[/(\d+\.\d+.\d+)/]`

Supplies the storage location (URL) for the scanner. Required

Default value: `$comply::scanner_source`

### `comply::scanners::oscap`

Installs the oscap scanner on to a system. Linux only

#### Examples

#####

```puppet
include comply::scanners::oscap
```

## Functions

### `report_errors`

Type: Ruby 4.x API

Returns error details

Returns error details

#### Examples

#####

```puppet
report_erros('[a, hash, of, errors]', true)
```

#### `report_errors(ResultSet $error_hash, Optional[Boolean] $allow_exit_code2)`

The report_errors function.

Returns: `String` Returns error string

##### Examples

######

```puppet
report_erros('[a, hash, of, errors]', true)
```

##### `error_hash`

Data type: `ResultSet`



##### `allow_exit_code2`

Data type: `Optional[Boolean]`



## Data types

### `Comply::Url`

Comply url

Comply url

Alias of `Variant[Array[Stdlib::HTTPUrl], Stdlib::HTTPUrl]`

## Tasks

### `ciscat_scan`

Run a ciscat scan and upload to scarp

**Supports noop?** false

#### Parameters

##### `benchmark`

Data type: `Optional[String[1]]`

Name of the benchmark file to run with the scan. Mutually exclusive with scan_hash.

##### `comply_server`

Data type: `String[1]`

Name of the FQDB comply server to upload to. NB passing 'nil' will prevent the upload

##### `comply_port`

Data type: `String[1]`

Port of comply server is on

##### `profile`

Data type: `Optional[String[1]]`

Name of the profile to run with the scan. This will use the default profile for that benchmark, if not specified.

##### `scan_hash`

Data type: `Optional[String[1]]`

JSON struct in string format of benchmarks/profiles and their machine names. Mutually exclusive with scan_hash.

### `oscap_scan`

Run an oscap scan

**Supports noop?** false

#### Parameters

##### `profile`

Data type: `String[1]`

Name of the profile to run with the scan

##### `benchmark`

Data type: `Optional[String[1]]`

Name of the benchmark file to run with the scan. If left empty it will default to the appropriate OS scan

### `scarp`

runs scarp

**Supports noop?** false

#### Parameters

##### `result_file`

Data type: `Optional[String[1]]`

The full path to result file to parse, Otherwise it looks in %TEMP%/xccdf-results.xml

##### `scarp_server`

Data type: `String[1]`

The scarp server to upload to

##### `format`

Data type: `String[1]`

The format of the scan result file

##### `unsafe`

Data type: `Optional[Boolean]`

Whether to send the result encrypted

## Plans

### `comply::demo_01_provision_machines`

Provisions machines from the provision type

#### Examples

#####

```puppet
comply::demo_01_provision_machines
```

#### Parameters

The following parameters are available in the `comply::demo_01_provision_machines` plan.

##### `provision_type`

Data type: `Optional[Enum['abs', 'vmpooler']]`



Default value: `'abs'`

### `comply::demo_02_pe_server_setup`

Install PE and comply module on designated machine

#### Examples

#####

```puppet
comply::demo_02_pe_server_setup
```

### `comply::demo_03_puppet_agents_setup`

Setup agents with scanners and java

#### Examples

#####

```puppet
comply::demo_03_puppet_agents_setup
```

#### Parameters

The following parameters are available in the `comply::demo_03_puppet_agents_setup` plan.

##### `scanner`

Data type: `Enum['oscap','ciscat']`

The scanner to be installed

Default value: `'ciscat'`

### `comply::demo_04_comply_stack_setup`

Setup comply server

#### Examples

#####

```puppet
comply::demo_04_comply_stack_setup image_version=latest
```

#### Parameters

The following parameters are available in the `comply::demo_04_comply_stack_setup` plan.

##### `image_version`

Data type: `Enum['latest', 'master']`



